---
title: "RMSD-Pred: Binding Pose Quality Assessment with GNN"
date: 2026-02-20 10:01:00 +0900
categories: [Projects, Protein-Ligand]
tags: [gnn, binding-pose, rmsd, protein-ligand, graph-neural-network]
math: true
---

> GitHub: [eightmm/RMSD-Pred](https://github.com/eightmm/RMSD-Pred) \| `pip install bindingrmsd`
{: .prompt-info }

## Overview

**RMSD-Pred**는 단백질-리간드 결합 포즈의 품질을 평가하는 GNN 모델이다. 도킹 결과물의 RMSD를 예측하고, 해당 포즈가 native conformation에 가까운지(2Å 이하) 판별하는 dual prediction을 수행한다.

도킹 프로그램이 생성한 포즈 중 어떤 것이 실제 결합 구조에 가까운지 **실험 데이터 없이** scoring할 수 있다.

## Model Architecture

### Three-Graph Representation

BA-Pred와 동일한 multi-graph 프레임워크를 기반으로 하되, 단백질 그래프의 feature encoding이 다르다:

| Graph | 특징 |
|-------|------|
| **Protein Graph** | Residue-level + atom-level dual embedding, 4Å cutoff |
| **Ligand Graph** | 57D atom features + 13D bond features |
| **Complex Graph** | 5Å 내 상호작용, 15D interaction features |

### Protein Encoding

BA-Pred가 원자 수준의 화학적 특성만 인코딩하는 반면, RMSD-Pred는 **잔기 수준 정보를 추가로 활용**한다:

- `token_res`: 잔기 종류 (22종) → Embedding(22, 128)
- `token_atom`: 단백질 원자 종류 (175종) → Embedding(175, 128)
- **Edge features**: 원자 간 거리를 15D Gaussian RBF로 인코딩

이를 통해 단백질의 서열 정보와 구조 정보를 함께 반영한다.

### GatedGCN-LSPE

각 블록(단백질, 리간드, 복합체)마다 **4개의 GatedGCN-LSPE 레이어**를 사용한다.

$$h_j^{(l+1)} = A_1[h_j \| p_j] + \sum_{i \in \mathcal{N}(j)} \sigma_{ij} \cdot A_2[h_i \| p_i]$$

$$p_j^{(l+1)} = C_1 p_j + \sum_{i \in \mathcal{N}(j)} \sigma_{ij} \cdot C_2 p_i$$

여기서 $\sigma_{ij}$는 학습 가능한 gating weight, $p$는 20D random walk positional encoding이다.

핵심은 **alternating message passing**: 각 레이어에서 단백질/리간드 블록의 노드를 복합체 그래프에 합친 뒤 상호작용 정보를 전파하고, 다시 분리하여 residual로 더해준다.

### Dual Output Heads

동일한 아키텍처에서 두 가지 모델을 학습한다:

| Model | Weight | Task | Output |
|-------|--------|------|--------|
| `reg.pth` | Regression | RMSD 값 예측 | Continuous (Å) |
| `bce.pth` | Classification | 2Å 이상 여부 | Probability (0~1) |

```
Embedding Dimension: 256
GNN Layers: 4 per block (12 total)
Dropout: 0.15 (MLP), 0.2 (GNN)
```

## Usage

```bash
pip install bindingrmsd

bindingrmsd-inference -r protein.pdb -l ligands.sdf -o results.tsv
```

```python
from bindingrmsd.inference import inference

inference(
    protein_pdb="protein.pdb",
    ligand_file="ligands.sdf",
    output="results.tsv",
    batch_size=128,
    device="cuda"
)
```

### Output

```
Name        pRMSD   Is_Above_2A  ADG_Score
ligand_1    1.23    0.89         -8.5
ligand_2    3.45    0.12         -6.2
```

## BA-Pred vs RMSD-Pred

| | BA-Pred | RMSD-Pred |
|--|---------|-----------|
| **Task** | Binding affinity (pKd) | Pose RMSD |
| **Protein encoding** | Atom features (57D) | Residue + Atom embedding |
| **GNN layers** | 6 per block | 4 per block |
| **Output** | pKd, Kcal/mol | RMSD, Quality probability |
| **Use case** | 결합 강도 순위 | 도킹 포즈 선별 |

두 모델은 상호 보완적이다. RMSD-Pred로 신뢰할 수 있는 포즈를 선별한 뒤, BA-Pred로 binding affinity를 예측하는 파이프라인을 구성할 수 있다.
